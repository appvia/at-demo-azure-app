apiVersion: compute.appvia.io/v2beta1
kind: Cluster
metadata:
  annotations:
    appenvs.appvia.io/dev: "true"
    appenvs.appvia.io/gpu-test-dev: "true"
  labels:
    name: eks-megnh
    nvidia.com/gpu: "true"
  name: eks-megnh
  namespace: ws-myws
spec:
  allocation:
    type: all
  cloudAccessConfigRef:
    name: aws-nonprod
    namespace: ws-myws
  cloudResourceName: ws-myws-eks-megnh
  networking:
    authorizedMasterNetworks:
    - cidr: 0.0.0.0/0
      name: default
    authorizedNetworks:
    - cidr: 0.0.0.0/0
      name: default
    networkPlan: eks-standard
    networkRef:
      group: networking.appvia.io
      kind: NetworkFabric
      name: eks-megnh
      namespace: ws-myws
      version: v2beta1
  nodePools:
  - autoscaling:
      enabled: true
      maxSize: 10
      minSize: 1
    defaultUpdateOptions:
      cloudUpdateStrategy: CloudDefault
      replacementStrategy: None
    diskSize: 30
    image: AL2_x86_64
    logicalName: compute
    machine: t3.large
    providerDetails:
      eks: {}
      type: EKS
    size: 2
    spot: {}
  - autoscaling:
      enabled: true
      maxSize: 5
      minSize: 1
    defaultUpdateOptions:
      cloudUpdateStrategy: CloudDefault
      replacementStrategy: None
    description: gpu
    diskSize: 30
    image: AL2_x86_64_GPU
    labels:
      nvidia.com/device-plugin.config: tesla-t4
      nvidia.com/gpu: "true"
    logicalName: gpu
    machine: g4dn.xlarge
    size: 1
    spot: {}
    taints:
    - effect: NoSchedule
      key: nvidia.com/gpu
      value: "true"
  plan: eks-gpu-standard
  provider: EKS
  providerDetails:
    eks:
      adminARNs:
      - arn:aws:iam::982919317531:role/AWSReservedSSO_AWSAdministratorAccess_931415b332bab599
      cloudWatchLogging: {}
    type: EKS
  quotaLimits:
    default: small
    templates:
    - constraints:
        hardQuota:
          requests.cpu: "1"
          requests.memory: 2Gi
        limitRanges:
        - max:
            cpu: 256m
            ephemeral-storage: 2.25Gi
            memory: 512Mi
          type: Pod
      name: small
      resourceDefaults:
      - default:
          cpu: 256m
          ephemeral-storage: 10Mi
          memory: 512Mi
        defaultRequest:
          cpu: 50m
          memory: 200m
        type: Container
    - constraints:
        hardQuota:
          requests.cpu: 512m
          requests.memory: 1Gi
        limitRanges:
        - max:
            cpu: 512m
            ephemeral-storage: 4.5Gi
            memory: 1024Mi
          type: Pod
      name: medium
      resourceDefaults:
      - default:
          cpu: 512m
          ephemeral-storage: 500Mi
          memory: 1024Mi
        defaultRequest:
          cpu: 50m
          memory: 200m
        type: Container
    - constraints:
        hardQuota:
          requests.cpu: 4Gi
          requests.memory: 8Gi
        limitRanges:
        - max:
            cpu: "1"
            ephemeral-storage: 9Gi
            memory: 2Gi
          type: Pod
      name: large
      resourceDefaults:
      - default:
          cpu: "1"
          ephemeral-storage: 1Gi
          memory: 2Gi
        defaultRequest:
          cpu: 50m
          memory: 200Mi
        type: Container
  region: eu-west-2
  security:
    podSecurityStandard:
      allowed:
      - baseline
      - restricted
      defaultProfile: baseline
      enabled: true
  stage: nonprod
  version: "1.24"
